from pyqcm import *
set_global_parameter("nosym")
new_cluster_model('L4', 4, 0, generators=None, bath_irrep=False)
add_cluster('L4', [0, 0, 0], [[0, 0, 0], [1, 0, 0], [2, 0, 0], [3, 0, 0]], ref = 0)
lattice_model('1D_L4', [[4, 0, 0]], None)
interaction_operator('U', band1=1, band2=1)
interaction_operator('V', band1=1, band2=1, link=[1, 0, 0], amplitude=1)
interaction_operator('J', band1=1, band2=1, link=[1, 0, 0], type='Hund')
hopping_operator('t', [1, 0, 0], -1, band1=1, band2=1)
hopping_operator('ti', [1, 0, 0], -1, band1=1, band2=1, tau=2)
hopping_operator('tp', [2, 0, 0], -1, band1=1, band2=1)
hopping_operator('hx', [0, 0, 0], 1, band1=1, band2=1, tau=0, sigma=1)
hopping_operator('h', [0, 0, 0], 1, band1=1, band2=1, tau=0, sigma=3)
anomalous_operator('D', [1, 0, 0], 1, band1=1, band2=1)
anomalous_operator('Di', [1, 0, 0], 1j, band1=1, band2=1)
anomalous_operator('S', [0, 0, 0], 1, band1=1, band2=1)
anomalous_operator('Si', [0, 0, 0], 1j, band1=1, band2=1)
anomalous_operator('Pz', [1, 0, 0], 1, band1=1, band2=1, type='dz')
anomalous_operator('Py', [1, 0, 0], 1, band1=1, band2=1, type='dy')
anomalous_operator('Px', [1, 0, 0], 1, band1=1, band2=1, type='dx')
density_wave('M', 'Z', [1, 0, 0])
density_wave('H', 'Z', [0, 0, 0])
density_wave('Hx', 'X', [0, 0, 0])
density_wave('cdw', 'N', [1, 0, 0])
explicit_operator('V0m', [([0, 0, 0], [0, 0, 0], 0.7071067811865476), ([3, 0, 0], [0, 0, 0], 0.7071067811865476)], tau=0, type='one-body')
explicit_operator('V1m', [([0, 0, 0], [0, 0, 0], 0.7071067811865476), ([3, 0, 0], [0, 0, 0], -0.7071067811865476)], tau=0, type='one-body')

try:
    import model_extra
except:
    pass		
set_target_sectors(['R0:N4'])
set_parameters("""

t=1
U=4
mu = 2
hx = 0.1
""")
set_parameter("U", 4.0)
set_parameter("hx", 0.1)
set_parameter("mu", 2.0)
set_parameter("t", 1.0)

new_model_instance(0)

solution=[None]*1

#--------------------- cluster no 1 -----------------
solution[0] = """
U	4
hx	0.1
mu	2
t	1

GS_energy: -9.95315 GS_sector: R0:N4:1
GF_format: bl
mixing	2
state
R0:N4	-9.95315	1
w	8	64
-1.2300107267479	-0.34463034271479	-0.25987629129395	0.25987629129395	0.34463034271479	-0.34463034271479	-0.25987629129395	0.25987629129395	0.34463034271479
-1.4300107267479	-0.34463034271479	-0.25987629129395	0.25987629129395	0.34463034271479	0.34463034271479	0.25987629129395	-0.25987629129395	-0.34463034271479
-1.855228860109	0.13825776021015	0.34467303723484	0.34467303723484	0.13825776021015	0.13825776021015	0.34467303723484	0.34467303723484	0.13825776021015
-2.055228860109	0.13825776021015	0.34467303723484	0.34467303723484	0.13825776021015	-0.13825776021015	-0.34467303723484	-0.34467303723484	-0.13825776021015
-2.4517638558916	-0.2817328361066	-0.15737478135223	-0.15737478135223	-0.28173283610661	-0.2817328361066	-0.15737478135222	-0.15737478135222	-0.2817328361066
-2.6517638558916	-0.2817328361066	-0.15737478135222	-0.15737478135222	-0.2817328361066	0.28173283610661	0.15737478135223	0.15737478135223	0.28173283610661
-2.9468573968759	-0.078145606614449	-0.052720087303288	0.052720087303286	0.078145606614447	-0.078145606614445	-0.052720087303286	0.052720087303286	0.078145606614446
-3.1468573968759	-0.078145606614446	-0.052720087303287	0.052720087303287	0.078145606614446	0.078145606614447	0.052720087303286	-0.052720087303287	-0.078145606614448
-3.6056436070347	-0.14892951359685	0.072526934063297	-0.072526934063296	0.14892951359685	-0.14892951359685	0.072526934063295	-0.072526934063295	0.14892951359685
-3.8056436070347	0.14892951359685	-0.072526934063295	0.072526934063295	-0.14892951359685	-0.14892951359685	0.072526934063298	-0.072526934063297	0.14892951359685
-4.1685770962046	-0.029744222692259	0.10092265458575	0.10092265458575	-0.029744222692259	-0.029744222692258	0.10092265458575	0.10092265458575	-0.029744222692258
-4.3685770962046	0.029744222692255	-0.10092265458574	-0.10092265458574	0.029744222692255	-0.02974422269226	0.10092265458575	0.10092265458575	-0.029744222692262
-4.3889878009854	-0.058914298967291	0.11706812355985	0.11706812355985	-0.058914298967292	-0.058914298967286	0.11706812355984	0.11706812355984	-0.058914298967286
-4.5889878009854	0.058914298967288	-0.11706812355984	-0.11706812355985	0.058914298967287	-0.05891429896729	0.11706812355985	0.11706812355985	-0.058914298967291
-5.0820458825321	0.0099354811544225	-0.079444420224337	0.079444420224337	-0.0099354811544222	0.009935481154422	-0.079444420224336	0.079444420224335	-0.0099354811544217
-5.2820458825321	0.0099354811544219	-0.079444420224334	0.079444420224337	-0.0099354811544222	-0.0099354811544217	0.079444420224336	-0.079444420224338	0.0099354811544224
-6.624244734837	0.00040659054635789	-0.016623934309991	-0.016623934309991	0.00040659054635743	0.0004065905463577	-0.016623934309991	-0.016623934309991	0.00040659054635781
-6.824244734837	-0.00040659054635755	0.016623934309991	0.016623934309991	-0.00040659054635766	0.00040659054635772	-0.016623934309991	-0.016623934309991	0.00040659054635787
-7.3173028163837	-9.9810455656511e-05	0.005601114392859	-0.0056011143928589	9.9810455655972e-05	-9.9810455656284e-05	0.005601114392859	-0.0056011143928591	9.9810455656498e-05
-7.5173028163837	-9.9810455656232e-05	0.0056011143928592	-0.0056011143928593	9.9810455656279e-05	9.9810455656204e-05	-0.0056011143928588	0.0056011143928589	-9.9810455656596e-05
-7.5377135211645	0.00028445671976635	-0.01673832820062	0.01673832820062	-0.00028445671976629	0.0002844567197664	-0.016738328200619	0.01673832820062	-0.00028445671976628
-7.7377135211645	-0.0002844567197664	0.01673832820062	-0.016738328200619	0.00028445671976633	0.00028445671976643	-0.01673832820062	0.01673832820062	-0.00028445671976637
-8.1006470103345	-5.5447403143984e-05	0.0041544756847362	0.0041544756847364	-5.5447403143808e-05	-5.5447403143841e-05	0.0041544756847364	0.0041544756847363	-5.5447403143617e-05
-8.3006470103345	5.5447403143893e-05	-0.0041544756847363	-0.0041544756847364	5.5447403143782e-05	-5.5447403143821e-05	0.0041544756847364	0.0041544756847364	-5.5447403143869e-05
-8.7594332204932	-7.1663840466632e-05	0.0069012595358208	0.0069012595358206	-7.1663840466721e-05	-7.1663840466689e-05	0.0069012595358206	0.0069012595358207	-7.1663840466825e-05
-8.9594332204932	7.1663840466866e-05	-0.0069012595358206	-0.0069012595358206	7.1663840466851e-05	-7.1663840466703e-05	0.0069012595358207	0.0069012595358207	-7.1663840466808e-05
-9.2545267614775	1.0894184480998e-05	-0.0012503843297915	0.0012503843297912	-1.089418448086e-05	1.0894184480774e-05	-0.0012503843297915	0.0012503843297915	-1.0894184481088e-05
-9.4545267614775	-1.0894184481128e-05	0.0012503843297913	-0.0012503843297916	1.0894184481083e-05	1.0894184480668e-05	-0.0012503843297913	0.0012503843297917	-1.0894184480853e-05
-9.8510617572601	1.0582254375146e-05	-0.0015131205814084	0.0015131205814089	-1.058225437474e-05	1.0582254375201e-05	-0.0015131205814084	0.0015131205814087	-1.0582254375159e-05
-10.05106175726	1.0582254374961e-05	-0.0015131205814089	0.0015131205814084	-1.058225437521e-05	-1.0582254375139e-05	0.0015131205814088	-0.0015131205814083	1.0582254375172e-05
-10.476279890621	-1.182780139497e-06	0.00020501763914006	0.00020501763914016	-1.1827801393646e-06	-1.1827801392618e-06	0.00020501763913984	0.00020501763913963	-1.1827801397565e-06
-10.676279890621	1.1827801395508e-06	-0.00020501763913981	-0.00020501763913987	1.1827801394972e-06	-1.1827801393966e-06	0.00020501763914007	0.00020501763914001	-1.1827801395076e-06
1.2300107267479	-0.34463034271479	0.25987629129395	0.25987629129395	-0.34463034271479	0.34463034271479	-0.25987629129395	-0.25987629129395	0.34463034271479
1.4300107267479	-0.34463034271479	0.25987629129395	0.25987629129395	-0.34463034271479	-0.34463034271479	0.25987629129395	0.25987629129395	-0.34463034271479
1.855228860109	0.13825776021015	-0.34467303723484	0.34467303723484	-0.13825776021015	-0.13825776021015	0.34467303723484	-0.34467303723484	0.13825776021015
2.055228860109	0.13825776021015	-0.34467303723483	0.34467303723484	-0.13825776021015	0.13825776021015	-0.34467303723484	0.34467303723484	-0.13825776021015
2.4517638558916	-0.2817328361066	0.15737478135223	-0.15737478135223	0.2817328361066	0.2817328361066	-0.15737478135222	0.15737478135222	-0.2817328361066
2.6517638558916	0.2817328361066	-0.15737478135222	0.15737478135222	-0.2817328361066	0.2817328361066	-0.15737478135222	0.15737478135222	-0.2817328361066
2.9468573968759	-0.078145606614447	0.052720087303287	0.052720087303286	-0.078145606614448	0.078145606614449	-0.052720087303287	-0.052720087303285	0.078145606614445
3.1468573968759	0.078145606614446	-0.052720087303286	-0.052720087303286	0.078145606614446	0.078145606614448	-0.052720087303287	-0.052720087303287	0.078145606614447
3.6056436070347	0.14892951359685	0.072526934063297	0.072526934063297	0.14892951359685	-0.14892951359685	-0.072526934063298	-0.072526934063294	-0.14892951359685
3.8056436070347	-0.14892951359685	-0.072526934063296	-0.072526934063297	-0.14892951359685	-0.14892951359685	-0.072526934063296	-0.072526934063298	-0.14892951359685
4.1685770962046	0.029744222692256	0.10092265458575	-0.10092265458575	-0.02974422269226	-0.029744222692258	-0.10092265458574	0.10092265458574	0.029744222692258
4.3685770962046	-0.029744222692256	-0.10092265458574	0.10092265458574	0.029744222692255	-0.029744222692261	-0.10092265458575	0.10092265458575	0.02974422269226
4.3889878009854	-0.058914298967291	-0.11706812355985	0.11706812355985	0.05891429896729	0.058914298967287	0.11706812355984	-0.11706812355984	-0.058914298967288
4.5889878009854	0.058914298967289	0.11706812355985	-0.11706812355985	-0.058914298967288	0.058914298967289	0.11706812355985	-0.11706812355985	-0.058914298967289
5.0820458825321	-0.0099354811544223	-0.079444420224337	-0.079444420224337	-0.0099354811544224	0.0099354811544223	0.079444420224336	0.079444420224337	0.009935481154422
5.2820458825321	0.0099354811544212	0.079444420224336	0.079444420224336	0.009935481154422	0.0099354811544218	0.079444420224336	0.079444420224337	0.0099354811544221
6.624244734837	-0.00040659054635755	-0.016623934309991	0.016623934309991	0.00040659054635762	0.00040659054635754	0.016623934309991	-0.016623934309991	-0.00040659054635747
6.824244734837	-0.00040659054635766	-0.016623934309991	0.016623934309991	0.00040659054635784	-0.00040659054635741	-0.016623934309991	0.016623934309991	0.00040659054635752
7.3173028163837	9.981045565626e-05	0.0056011143928592	0.0056011143928591	9.9810455656466e-05	-9.9810455656557e-05	-0.0056011143928593	-0.005601114392859	-9.9810455656352e-05
7.5173028163837	9.981045565652e-05	0.0056011143928588	0.0056011143928592	9.9810455656513e-05	9.9810455656495e-05	0.0056011143928591	0.0056011143928588	9.9810455656265e-05
7.5377135211645	0.00028445671976626	0.016738328200619	0.01673832820062	0.00028445671976637	-0.00028445671976633	-0.01673832820062	-0.016738328200619	-0.0002844567197664
7.7377135211645	0.0002844567197662	0.01673832820062	0.01673832820062	0.00028445671976641	0.0002844567197664	0.016738328200619	0.016738328200619	0.00028445671976643
8.1006470103345	5.5447403143678e-05	0.0041544756847364	-0.0041544756847359	-5.5447403143843e-05	-5.5447403143849e-05	-0.0041544756847362	0.0041544756847369	5.5447403143697e-05
8.3006470103345	-5.5447403143753e-05	-0.0041544756847363	0.0041544756847362	5.5447403143915e-05	-5.544740314391e-05	-0.0041544756847362	0.0041544756847364	5.5447403143773e-05
8.7594332204932	-7.166384046688e-05	-0.0069012595358209	0.0069012595358209	7.16638404669e-05	7.1663840466664e-05	0.006901259535821	-0.0069012595358208	-7.1663840466816e-05
8.9594332204932	7.1663840466772e-05	0.0069012595358207	-0.0069012595358206	-7.1663840466912e-05	7.1663840466866e-05	0.0069012595358208	-0.0069012595358206	-7.1663840466984e-05
9.2545267614775	-1.0894184480663e-05	-0.0012503843297919	-0.0012503843297912	-1.0894184480886e-05	1.0894184481093e-05	0.0012503843297914	0.0012503843297913	1.0894184480985e-05
9.4545267614775	1.0894184480752e-05	0.0012503843297915	0.0012503843297913	1.0894184481026e-05	1.0894184481222e-05	0.0012503843297913	0.0012503843297917	1.089418448074e-05
9.8510617572601	1.0582254375281e-05	0.0015131205814085	0.0015131205814085	1.0582254375167e-05	-1.0582254375366e-05	-0.0015131205814084	-0.0015131205814087	-1.058225437494e-05
10.05106175726	-1.0582254375032e-05	-0.0015131205814086	-0.0015131205814083	-1.0582254375242e-05	-1.0582254375017e-05	-0.0015131205814086	-0.0015131205814085	-1.0582254375066e-05
10.476279890621	-1.1827801393544e-06	-0.00020501763913994	0.00020501763913969	1.1827801398201e-06	1.1827801394475e-06	0.00020501763913984	-0.00020501763914004	-1.1827801393452e-06
10.676279890621	1.1827801394598e-06	0.00020501763913994	-0.00020501763913998	-1.1827801396424e-06	1.1827801395561e-06	0.00020501763913993	-0.00020501763913985	-1.1827801395812e-06

"""
read_cluster_model_instance(solution[0], 0)
