# PyQCM installation

## Defaut installation using pip

This is the most basic installation of PyQCM, suitable for all user with default system compiler and library.

1. Open a terminal and clone PyQCM Git repository:

```
git clone https://bitbucket.org/dsenechQCM/qcm_wed.git
cd qcm_wed #enter cloned repository
```

2. Perform automatic installation with `pip`:

```
pip install .
```

## Installation from source


1. Clone PyQCM and download CUBA source:

```
git clone https://bitbucket.org/dsenechQCM/qcm_wed.git
wget http://www.feynarts.de/cuba/Cuba-4.2.1.tar.gz
tar -xf Cuba-4.2.1.tar.gz
```

2. Configure and compile CUBA:

```
cd Cuba-4.2.1 #enter extraction CUBA directory
./configure CFLAGS="-O3 -fPIC -ffast-math -fomit-frame-pointer"
make lib
cd .. #return common directory
```

3. Configure and compile QCM library:

```
cd qcm_wed #enter extraction CUBA directory
mkdir build && cd build
cmake .. -DCMAKE_BUILD_TYPE=Release -DCUBA_DIR=../CUBA-4.2.1
make
```

4. Install Python library:

#TODO


## Custom installation on Compute Canada server

### Compilation on Intel based cluster with ICC compiler

CUBA configure step (2): 

```
./configure FC=`which ifort` CC=`which icc` CFLAGS="-O3 -fPIC"
```

QCM configure step (3) with CMake:

```
cmake .. -DCMAKE_BUILD_TYPE=Release -DCUBA_DIR=../CUBA-4.2.1 -DCMAKE_CXX_COMPILER=`which icc` -DBLA_VENDOR=Intel10_64lp_seq -DCMAKE_INCLUDE_PATH=${MKLLROOT}/lib/intel64_lin/
```

### Compilation with FlexiBLAS

QCM configure step (3) with CMake 3.21.4: 

```
module load cmake/3.21.4
cmake .. -DCMAKE_BUILD_TYPE=Release -DCUBA_DIR=../CUBA-4.2.1 -DBLA_VENDOR=FlexiBLAS
```


